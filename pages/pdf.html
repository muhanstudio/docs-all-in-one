<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>PDF Viewer</title>
  <style>
    #pdfContainer {
      position: relative;
      width: 100%;
      height: 100vh;
    }

    #pdfViewer canvas {
      display: block;
    }
  </style>
  <script src="../static/pdf.js"></script>
</head>
<body>
  <input type="file" accept=".pdf" id="pdfFileInput">
  <div id="pdfContainer">
    <button id="prevPageButton">上一页</button>
    <button id="nextPageButton">下一页</button>
    <div id="pdfViewer"></div>
  </div>

  <script>
    var pdfDoc = null;
    var pageNum = 1;
    var scale = 1.5;

    document.getElementById('pdfFileInput').addEventListener('change', function(e) {
      var file = e.target.files[0];
      var reader = new FileReader();

      reader.onload = function() {
        var typedarray = new Uint8Array(this.result);
        displayPDF(typedarray);
      };

      reader.readAsArrayBuffer(file);
    });

    function displayPDF(data) {
      pdfjsLib.getDocument(data).promise.then(function(pdf) {
        pdfDoc = pdf;
        renderPage(pageNum);
      });
    }

    function renderPage(num) {
      pdfDoc.getPage(num).then(function(page) {
        var pdfCanvas = document.createElement('canvas');
        var context = pdfCanvas.getContext('2d');
        var viewport = page.getViewport({ scale: scale });

        pdfCanvas.width = viewport.width;
        pdfCanvas.height = viewport.height;

        var renderContext = {
          canvasContext: context,
          viewport: viewport
        };

        page.render(renderContext).promise.then(function() {
          var container = document.getElementById('pdfViewer');
          container.innerHTML = '';
          container.appendChild(pdfCanvas);
        });
      });
    }

    document.getElementById('prevPageButton').addEventListener('click', function() {
      if (pageNum > 1) {
        pageNum--;
        renderPage(pageNum);
      }
    });

    document.getElementById('nextPageButton').addEventListener('click', function() {
      if (pageNum < pdfDoc.numPages) {
        pageNum++;
        renderPage(pageNum);
      }
    });
  </script>
</body>
</html>